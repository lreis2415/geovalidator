@prefix data: <http://www.egc.org/ont/data#> .
@prefix process: <http://www.egc.org/ont/process#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix sh: <http://www.w3.org/ns/shacl#> .
@prefix soft: <http://www.egc.org/ont/cyber#> .
@prefix xml: <http://www.w3.org/XML/1998/namespace> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .

process:DataThemePropertyShape a sh:PropertyShape ;
    sh:path data:dataTheme ;
    sh:sparql [ sh:message "Input data theme must consistent with output data theme of pre-processor."@en ;
            sh:prefixes [ a sh:PrefixDeclaration ;
                    sh:declare [ sh:namespace "http://www.egc.org/ont/process#"^^xsd:anyURI ;
                            sh:prefix "process" ],
                        [ sh:namespace "http://www.egc.org/ont/cyber#"^^xsd:anyURI ;
                            sh:prefix "soft" ] ] ;
            sh:select """
SELECT $this  (?in_theme AS ?value)
	WHERE {
		$this  soft:input  ?in_param. # input parameter
		?in_param  $PATH   ?in_theme.  # data theme of input parameter 
        $this  process:preprocessor  ?pre_func.   # preceding functionality
        ?pre_func soft:output  ?out_param.  #  output parameter
		?out_param  $PATH  ?out_theme.   #  data theme of output parameter
		FILTER (  ?in_theme = ?out_theme  ). # is equal
        }
""" ] ;
    sh:targetSubjectsOf process:preprocessor .

